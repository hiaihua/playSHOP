(function(e){function k(n,d,r){var o=n.offset().top,q=n.offset().left,i=r.position.split(/,?\s+/),p=i[0];i=i[1];o-=d.outerHeight()-r.offset[0];q+=n.outerWidth()+r.offset[1];r=d.outerHeight()+n.outerHeight();if(p=="center"){o+=r/2}if(p=="bottom"){o+=r}n=n.outerWidth();if(i=="center"){q-=(n+d.outerWidth())/2}if(i=="left"){q-=n}return{top:o,left:q}}function j(i){function d(){return this.getAttribute("type")==i}d.key="[type="+i+"]";return d}function m(n,d,q){function o(t,u,r){if(!(!q.grouped&&t.length)){var s;if(r===false||e.isArray(r)){s=c.messages[u.key||u]||c.messages["*"];s=s[q.lang]||c.messages["*"].en;(u=s.match(/\$\d/g))&&e.isArray(r)&&e.each(u,function(v){s=s.replace(this,r[v])})}else{s=r[q.lang]||r}t.push(s)}}var p=this,i=d.add(p);n=n.not(":button, :image, :reset, :submit");e.extend(p,{getConf:function(){return q},getForm:function(){return d},getInputs:function(){return n},invalidate:function(s,t){if(!t){var r=[];e.each(s,function(u,v){u=n.filter("[name="+u+"]");if(u.length){u.trigger("OI",[v]);r.push({input:u,messages:[v]})}});s=r;t=e.Event()}t.type="onFail";i.trigger(t,[s]);t.isDefaultPrevented()||a[q.effect][0].call(p,s,t);return p},reset:function(r){r=r||n;r.removeClass(q.errorClass).each(function(){var s=e(this).data("msg.el");if(s){s.remove();e(this).data("msg.el",null)}}).unbind(q.errorInputEvent||"");return p},destroy:function(){d.unbind(q.formEvent).unbind("reset.V");n.unbind(q.inputEvent||"").unbind("change.V");return p.reset()},checkValidity:function(t,u){t=t||n;t=t.not(":disabled");if(!t.length){return true}u=u||e.Event();u.type="onBeforeValidate";i.trigger(u,[t]);if(u.isDefaultPrevented()){return u.result}var r=[],s=q.errorInputEvent+".v";t.each(function(){var x=[],w=e(this).unbind(s).data("messages",x);e.each(l,function(){var A=this,z=A[0];if(w.filter(z).length){A=A[1].call(p,w,w.val());if(A!==true){u.type="onBeforeFail";i.trigger(u,[w,z]);if(u.isDefaultPrevented()){return false}var y=w.attr(q.messageAttr);if(y){x=[y];return false}else{o(x,z,A)}}}});if(x.length){r.push({input:w,messages:x});w.trigger("OI",[x]);q.errorInputEvent&&w.bind(s,function(y){p.checkValidity(w,y)})}if(q.singleError&&r.length){return false}});var v=a[q.effect];if(!v){throw'Validator: cannot find effect "'+q.effect+'"'}if(r.length){p.invalidate(r,u);return false}else{v[1].call(p,t,u);u.type="onSuccess";i.trigger(u,[t]);t.unbind(s)}return true}});e.each("onBeforeValidate,onBeforeFail,onFail,onSuccess".split(","),function(r,s){e.isFunction(q[s])&&e(p).bind(s,q[s]);p[s]=function(t){e(p).bind(s,t);return p}});q.formEvent&&d.bind(q.formEvent,function(r){if(!p.checkValidity(null,r)){return r.preventDefault()}});d.bind("reset.V",function(){p.reset()});n[0]&&n[0].validity&&n.each(function(){this.oninvalid=function(){return false}});if(d[0]){d[0].checkValidity=p.checkValidity}q.inputEvent&&n.bind(q.inputEvent,function(r){p.checkValidity(e(this),r)});n.filter(":checkbox, select").filter("[required]").bind("change.V",function(r){var s=e(this);if(this.checked||s.is("select")&&e(this).val()){a[q.effect][1].call(p,s,r)}})}e.tools=e.tools||{version:"1.2.3"};var h=/\[type=([a-z]+)\]/,g=/^-?[0-9]*(\.[0-9]+)?$/,f=/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i,b=/^(https?:\/\/)?([\da-z\.\-]+)\.([a-z\.]{2,6})([\/\w \.\-]*)*\/?$/i,c;c=e.tools.validator={conf:{grouped:false,effect:"default",errorClass:"invalid",inputEvent:null,errorInputEvent:"keyup",formEvent:"submit",lang:"en",message:"<div/>",messageAttr:"data-message",messageClass:"error",offset:[0,0],position:"center right",singleError:false,speed:"normal"},messages:{"*":{en:"Please correct this value"}},localize:function(i,d){e.each(d,function(o,n){c.messages[o]=c.messages[o]||{};c.messages[o][i]=n})},localizeFn:function(i,d){c.messages[i]=c.messages[i]||{};e.extend(c.messages[i],d)},fn:function(i,d,n){if(e.isFunction(d)){n=d}else{if(typeof d=="string"){d={en:d}}this.messages[i.key||i]=d}if(d=h.exec(i)){i=j(d[1])}l.push([i,n])},addEffect:function(i,d,n){a[i]=[d,n]}};var l=[],a={"default":[function(i){var d=this.getConf();
e.each(i,function(p,n){p=n.input;p.addClass(d.errorClass);var o=p.data("msg.el");if(!o){o=e(d.message).addClass(d.messageClass).appendTo(document.body);p.data("msg.el",o)}o.css({visibility:"hidden"}).find("span").remove();e.each(n.messages,function(q,r){e("<span/>").html(r).appendTo(o)});o.outerWidth()==o.parent().width()&&o.add(o.find("p")).css({display:"inline"});n=k(p,o,d);o.css({visibility:"visible",position:"absolute",top:n.top,left:n.left}).fadeIn(d.speed)})},function(i){var d=this.getConf();i.removeClass(d.errorClass).each(function(){var n=e(this).data("msg.el");n&&n.css({visibility:"hidden"})})}]};e.each("email,url,number".split(","),function(i,d){e.expr[":"][d]=function(n){return n.getAttribute("type")===d}});e.fn.oninvalid=function(d){return this[d?"bind":"trigger"]("OI",d)};c.fn(":email","Please enter a valid email address",function(i,d){return !d||f.test(d)});c.fn(":url","Please enter a valid URL",function(i,d){return !d||b.test(d)});c.fn(":number","Please enter a numeric value.",function(i,d){return g.test(d)});c.fn("[max]","Please enter a value smaller than $1",function(i,d){if(e.tools.dateinput&&i.is(":date")){return true}i=i.attr("max");return parseFloat(d)<=parseFloat(i)?true:[i]});c.fn("[min]","Please enter a value larger than $1",function(i,d){if(e.tools.dateinput&&i.is(":date")){return true}i=i.attr("min");return parseFloat(d)>=parseFloat(i)?true:[i]});c.fn("[required]","Please complete this mandatory field.",function(i,d){if(i.is(":checkbox")){return i.is(":checked")}return !!d});c.fn("[pattern]",function(i){var d=new RegExp("^"+i.attr("pattern")+"$");return d.test(i.val())});e.fn.validator=function(i){var d=this.data("validator");if(d){d.destroy();this.removeData("validator")}i=e.extend(true,{},c.conf,i);if(this.is("form")){return this.each(function(){var n=e(this);d=new m(n.find(":input"),n,i);n.data("validator",d)})}else{d=new m(this,this.eq(0).closest("form"),i);return this.data("validator",d)}}})(jQuery);